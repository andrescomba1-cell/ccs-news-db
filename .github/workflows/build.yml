name: Deploy Pages (minimal)

on:
  workflow_dispatch:   # lo lanzas a mano
  push:
    branches: [ main ] # y tambiÃ©n cuando haces commit a main

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: "pages"
  cancel-in-progress: true

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Prepare public (write embed.html + index.html)
        run: |
          set -e
          rm -rf public
          mkdir -p public

          # --- ESTE embed.html usa la URL ABSOLUTA de tu JSON que ya funciona ---
          cat > public/embed.html <<'HTML'
          <!doctype html>
          <html lang="en">
          <head>
          <meta charset="utf-8">
          <meta name="viewport" content="width=device-width,initial-scale=1">
          <title>CCS News Embed</title>
          <style>
            :root{--brand:#0a6650}
            body{margin:0;font-family:system-ui,Segoe UI,Roboto,Arial;background:#fff;color:#111827}
            .wrap{max-width:1200px;margin:0 auto;padding:0 16px}
            h2{font-weight:700;color:var(--brand);margin:18px 0}
            #ccs-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:18px;margin:20px 0 32px}
            .card{border:1px solid #e5e7eb;border-radius:14px;overflow:hidden;background:#fff;box-shadow:0 3px 8px rgba(0,0,0,.06);display:flex;flex-direction:column;transition:transform .2s,box
